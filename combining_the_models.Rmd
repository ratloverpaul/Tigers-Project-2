---
title: "Combining Models"
author: "Paul Povel"
date: "2024-12-03"
output: html_document
---
```{r}
library(C50)
library(caret)
```
```{r}
# Load predictions from CSV files
ann_predictions <- read.csv("ANN_output.csv")
knn_predictions <- read.csv("knn_prediction.csv")
logistic_predictions <- read.csv("logistic_prediction.csv")
tree_predictions <- read.csv("pred_tree.csv")
random_forest_predictions <- read.csv("random_forest_pred.csv")
svm_predictions <- read.csv("svm_predictions.csv")

```
```{r}
# Combine model predictions into a single data frame
ensemble_df <- data.frame(
  ANN_Model = ann_predictions$V1,
  KNN_Model = knn_predictions$x,
  Logistic_Model = logistic_predictions$x,
  Decision_Tree = tree_predictions$x,
  Random_Forest = random_forest_predictions$V1,
  SVM = svm_predictions$x,
  booking_status =0
)

#Load cleaned dataset and extract booking status
clnd <- read.csv("cleaned.csv")
set.seed(12345)
#70:30 split
split_size <- .3
test_size <- split_size*nrow(clnd)
set.seed(12345)
test_rows <- sample(1:nrow(clnd), test_size)

#make test and train data
book_test <- clnd[test_rows, ]
ensemble_df$booking_status <- as.factor(book_test$booking.status)

# Summarize the combined data
summary(ensemble_df)

```
```{r}



# Split data into training and testing sets
split_size <- 0.3
test_size <- split_size * nrow(ensemble_df)
# Set seed for reproducibility
set.seed(12345)
test_rows <- sample(1:nrow(ensemble_df), test_size)

ensemble_test <- ensemble_df[test_rows, ]
ensemble_train <- ensemble_df[-test_rows, ]

```
```{r}
# Define cost matrix
cost_matrix <- matrix(c(0, 1, 3, 0), nrow = 2)

# Train a decision tree model
final_tree_model <- C5.0(as.factor(booking_status) ~ ., data = ensemble_train)

# Plot the decision tree
plot(final_tree_model)

```
```{r}
# Make predictions on the test data
final_predictions <- predict(final_tree_model, ensemble_test)

# Evaluate the model
conf_matrix <- confusionMatrix(final_predictions, ensemble_test$booking_status, positive = "1")

# Print confusion matrix and statistics
print(conf_matrix)

```






